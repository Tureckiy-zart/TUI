---
alwaysApply: true
title: npm Publishing Rules
version: 1.0
status: Active
owner: Cursor AI
last_updated: TODO:DATE_CONFIRMATION
---

# üì¶ npm Publishing Rules

This rule file defines standards for publishing UI library to npm, including versioning, changelog generation, and publishing workflow.

---

## üìã Part 1: Semantic Versioning (Semver)

### Version Format

**ALWAYS** use semantic versioning: `MAJOR.MINOR.PATCH`

- **MAJOR**: Breaking changes (incompatible API changes)
- **MINOR**: New features (backward compatible)
- **PATCH**: Bug fixes (backward compatible)

### Version Bump Rules

**MAJOR version** when:

- Component API changes (props removed/changed)
- Breaking changes in behavior
- Dependencies updated with breaking changes

**MINOR version** when:

- New components added
- New props added (backward compatible)
- New features added
- Dependencies updated (non-breaking)

**PATCH version** when:

- Bug fixes
- Documentation updates
- Internal refactoring (no API changes)
- Dependency patches

---

## üìù Part 2: Changelog Generation

### Changelog Format

**ALWAYS** maintain `CHANGELOG.md` with this format:

```markdown
# Changelog

## [1.2.0] - TODO:DATE_CONFIRMATION

### Added

- New Button component with variants
- Modal component with accessibility features

### Changed

- Updated Button styles for better contrast

### Fixed

- Fixed Modal focus trap issue
- Fixed Button disabled state styling

### Removed

- Deprecated `oldButton` component (use `Button` instead)
```

### Changelog Rules

- **ALWAYS** update changelog before release
- **ALWAYS** use conventional commit format
- **ALWAYS** include date for each version
- **ALWAYS** categorize changes (Added/Changed/Fixed/Removed)
- **NEVER** skip changelog updates

---

## üöÄ Part 3: Pre-Publish Checklist

### Pre-Publish Requirements

**ALWAYS** verify before publishing:

- [ ] All tests passing (`npm test`)
- [ ] Build successful (`npm run build`)
- [ ] No TypeScript errors (`npm run typecheck`)
- [ ] Linting passes (`npm run lint`)
- [ ] Changelog updated
- [ ] Version bumped in `package.json`
- [ ] Git tag created
- [ ] README.md updated (if needed)
- [ ] Examples tested
- [ ] Storybook builds successfully

### Pre-Publish Scripts

**ALWAYS** run pre-publish checks:

```bash
npm run pre-publish
# Should run: test, build, lint, typecheck
```

---

## üì¶ Part 4: package.json Configuration

### Required Fields

**ALWAYS** ensure `package.json` includes:

```json
{
  "name": "@your-org/ui-library",
  "version": "1.2.0",
  "description": "UI component library",
  "main": "dist/index.js",
  "module": "dist/index.esm.js",
  "types": "dist/index.d.ts",
  "files": ["dist", "README.md", "CHANGELOG.md"],
  "keywords": ["react", "components", "ui", "library"],
  "repository": {
    "type": "git",
    "url": "https://github.com/your-org/ui-library.git"
  },
  "publishConfig": {
    "access": "public"
  }
}
```

### Files to Include

**ALWAYS** include in npm package:

- `dist/` - Built files
- `README.md` - Documentation
- `CHANGELOG.md` - Version history
- `LICENSE` - License file

**NEVER** include:

- `src/` - Source files (unless needed)
- `node_modules/` - Dependencies
- `.git/` - Git files
- Test files
- Storybook files

---

## üîñ Part 5: Git Tagging

### Tag Format

**ALWAYS** create git tags for releases:

```bash
git tag -a v1.2.0 -m "Release v1.2.0: Added Button and Modal components"
git push origin v1.2.0
```

### Tag Rules

- **ALWAYS** use `v` prefix (e.g., `v1.2.0`)
- **ALWAYS** match package.json version
- **ALWAYS** include release notes in tag message
- **ALWAYS** push tags to remote

---

## üì§ Part 6: Publishing Workflow

### Publishing Steps

**ALWAYS** follow this workflow:

1. **Update version** in `package.json`
2. **Update CHANGELOG.md**
3. **Run pre-publish checks**
4. **Build package** (`npm run build`)
5. **Create git tag**
6. **Publish to npm** (`npm publish`)
7. **Push changes** to repository

### Publishing Commands

```bash
# 1. Update version
npm version patch|minor|major

# 2. Build
npm run build

# 3. Publish
npm publish

# 4. Push tags
git push --follow-tags
```

---

## üîí Part 7: Access Control

### npm Access

**ALWAYS** configure access:

- **Public packages**: `"access": "public"` in `publishConfig`
- **Private packages**: `"access": "restricted"` or use scoped packages
- **Organization**: Use `@your-org/` scope

### Authentication

**ALWAYS** authenticate before publishing:

```bash
npm login
npm whoami  # Verify authentication
```

---

## üß™ Part 8: Testing Published Package

### Verification Steps

**ALWAYS** test published package:

```bash
# Install from npm
npm install @your-org/ui-library@latest

# Test in clean project
# Verify imports work
# Verify types work
# Verify components render
```

---

## üìä Part 9: Release Notes

### Release Notes Format

**ALWAYS** create release notes:

```markdown
# Release v1.2.0

## Highlights

- Added Button component with 3 variants
- Added Modal component with accessibility features

## Breaking Changes

None

## Migration Guide

N/A (no breaking changes)

## Full Changelog

See [CHANGELOG.md](./CHANGELOG.md) for details
```

---

## üö´ What NOT to Do

- ‚ùå **NEVER** publish without tests passing
- ‚ùå **NEVER** skip version bump
- ‚ùå **NEVER** skip changelog update
- ‚ùå **NEVER** publish with `--force` (unless critical)
- ‚ùå **NEVER** skip git tagging
- ‚ùå **NEVER** publish source files (only dist/)
- ‚ùå **NEVER** skip pre-publish checks

---

## ‚úÖ What TO Do

- ‚úÖ **ALWAYS** follow semantic versioning
- ‚úÖ **ALWAYS** update changelog before release
- ‚úÖ **ALWAYS** run pre-publish checks
- ‚úÖ **ALWAYS** create git tags
- ‚úÖ **ALWAYS** test published package
- ‚úÖ **ALWAYS** document breaking changes
- ‚úÖ **ALWAYS** verify package.json configuration

---

## üìã Release Checklist

Before every release:

- [ ] Version bumped in package.json
- [ ] CHANGELOG.md updated
- [ ] All tests passing
- [ ] Build successful
- [ ] No TypeScript errors
- [ ] Linting passes
- [ ] Git tag created
- [ ] Package tested locally
- [ ] Published to npm
- [ ] Release notes created
- [ ] Changes pushed to repository

---

**Status:** ‚úÖ Active Rule  
**Priority:** CRITICAL  
**Date Created:** TODO:DATE_CONFIRMATION
